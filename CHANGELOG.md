# 更新日志

All notable changes to this project will be documented in this file.

## [1.0.2] - 2025-06-03

### 🎮 Added
- 🐙 **怪物库大幅扩展** - 新增22种敌对生物
  - 新增低危险怪物：🏹 沼骸、🐛 末影螨
  - 新增中危险怪物：🐷 猪灵、🐷‍☠️ 僵尸疣猪兽、👤 幻翼（更名）
  - 总计35种敌对生物，涵盖Minecraft几乎所有敌对生物（除末影龙）
- 📏 **智能距离生成系统**
  - 低危险怪物：0-3格随机距离生成
  - 中危险怪物：2-3格随机距离生成  
  - 高危险怪物：4-5格随机距离生成
  - 基于威胁等级的合理距离分配
- 🧠 **AI优化机制**
  - 怪物跟踪范围优化至32格（原版16格）
  - 10秒发光效果辅助初始目标锁定
  - 智能标签系统确保精确生成

### 🔧 Changed
- 🎯 **危险等级重新分配**
  - 👻 恼鬼、🔮 幻魔者 升级为高危险
  - 🐗 劫掠兽、🐷 蛮兵 调整为中危险
  - 更合理的威胁等级分布
- 📊 **日志系统优化**
  - 详细的距离策略日志输出
  - AI优化状态实时显示

### 🐛 Fixed
- 🔥 **配置热更新重大修复**
  - 修复修改触发数量后进度条上限不更新的问题
  - 实现真正的无重启配置更新
  - 内部计数器结构实时同步
  - 保留当前计数和触发次数不丢失
- 📊 **前端状态同步**
  - 配置保存后立即更新进度条显示
  - 实时反映触发要求变更
  - 优化状态刷新机制

### 🛠 Technical
- 🔄 **内部架构优化**
  - ruleCounters结构动态重建机制
  - 配置变更的智能检测和应用
  - 并发命令执行批次优化（从5个核心命令减少到4个）
- 📈 **性能提升**
  - 减少不必要的属性修改命令
  - 优化命令执行流水线
  - 降低服务器负载
- 🧪 **代码质量**
  - 保留随机距离实现的完整注释
  - 可随时恢复到8-12格随机生成
  - 增强代码可维护性

### 📊 Monster Statistics
- **总计**: 35种敌对生物
- **低危险**: 13种（基础威胁，近距离生成）
- **中危险**: 16种（中等威胁，适中距离）
- **高危险**: 6种（极高威胁，远距离生成）

## [1.0.1] - 2025-06-02

### 🎮 Added
- 📊 新增总累计关键词统计功能
  - 实时统计收到的关键词总数
  - 独立于触发次数的历史记录
  - 前端实时显示累计数据
- 🎯 优化RANDOM_MONSTER_SPAWN功能
  - 排除旁观者模式玩家作为生成目标
  - 使用 `gamemode=!spectator` 选择器
  - 提升游戏体验的合理性

### 🔧 Changed
- 📈 统计概览界面优化
  - "总触发次数" 改为 "总累计次数"
  - 显示接收到的关键词总数而非触发事件总数
  - 更直观的数据展示逻辑
- ⚓ 舰长测试功能精简
  - 移除舰长全部测试功能
  - 保留单独等级测试（总督/提督/舰长）
  - 简化用户界面操作

### 🐛 Fixed
- 🎮 修复旁观者模式玩家被选中问题
- 📊 修复统计数据显示逻辑
- 🖥️ 优化前端数据更新机制

### 🛠 Technical
- 🔧 增强数据持久性
  - 总累计数不会因重置计数器而丢失
  - 保持历史统计数据的连续性
- 📊 改进状态管理
  - 新增 `totalKeywordCount` 字段
  - 优化前后端数据同步
- 🎯 代码优化
  - 移除冗余测试功能代码
  - 改进玩家选择逻辑

## [1.0.0] - 2025-06-02

### 🎮 Added
- 🎮 完整的B站弹幕监听系统
- 🔧 支持Minecraft RCON协议
- 🌐 现代化Web管理界面
- 📡 Event Bridge WebSocket服务
- 💰 SuperChat事件支持
- 🎯 可配置的弹幕触发规则
- 📊 实时状态监控
- 🔄 自动重连机制

### 🎨 UI/UX
- 💫 美观的自定义tooltip效果
- 🏷 现代化变量标签设计
- 📱 响应式设计支持
- 🎪 流畅的动画效果

### 🛠 Technical
- 🔧 健壮的错误处理机制
- 📝 详细的日志系统
- ⚙️ 可视化配置管理
- 🧪 完整的测试功能

### 📦 Dependencies
- Express.js 4.18.2 - Web服务器框架
- ws 8.14.2 - WebSocket
- rcon 1.1.0 - RCON客户端
- uuid 9.0.1 - UUID生成库

### 🔧 Configuration
- 支持多命令触发规则
- 可配置的事件监听
- 灵活的RCON连接设置
- 可选的认证令牌支持

---

## [Future Releases]

### 计划中的功能
- 📈 数据统计仪表
- 🌍 多语言支持
- 🔔 通知系统

---

### 版本说明格式
- 🎮 **Added** - 新功能
- 🔧 **Changed** - 功能变更
- 🐛 **Fixed** - Bug修复
- 🎯 **Removed** - 移除的功能
- 🔒 **Security** - 安全相关
- ⚠️ **Deprecated** - 将被废弃的功能
